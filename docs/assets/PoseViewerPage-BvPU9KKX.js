import{r as e,_ as a,m as t,n,o,c as s,w as i,u as l,a as r,b as d,I as c,e as u,t as h,p as v,f as m,g as w}from"./index-CpnPqKFX.js";const p=e("Pre"),f=e=>{if(e&&e.srcObject){e.srcObject.getTracks().forEach((e=>e.stop())),e.srcObject=null}p.value="Pre"},g={class:"action-buttons"},y=a({__name:"PoseViewerPage",setup(a){const y=e(null),P=e(null),k=e=>{const a=P.value.getContext("2d");var t,n,o,s;a.clearRect(0,0,y.value.videoWidth,y.value.videoHeight),a.drawImage(e.image,0,0,P.value.width,P.value.height),e.poseLandmarks&&(t=a,n=e.poseLandmarks,o=window.POSE_CONNECTIONS,s={color:"white",lineWidth:2},t.strokeStyle=s.color,t.lineWidth=s.lineWidth,o.forEach((([e,a])=>{const o=n[e],s=n[a];o&&s&&(t.beginPath(),t.moveTo(o.x*t.canvas.width,o.y*t.canvas.height),t.lineTo(s.x*t.canvas.width,s.y*t.canvas.height),t.stroke())})),((e,a,t)=>{e.fillStyle=t.color,a.forEach((a=>{e.beginPath(),e.arc(a.x*e.canvas.width,a.y*e.canvas.height,t.lineWidth,0,2*Math.PI),e.fill()}))})(a,e.poseLandmarks,{color:"red",lineWidth:2}))},C=async()=>{await(async(e,a,t)=>{if(!window.Pose||!window.Camera)throw new Error("MediaPipe Pose or Camera not loaded. Ensure the scripts are loaded correctly.");const n=new window.Pose({locateFile:e=>"https://cdn.jsdelivr.net/npm/@mediapipe/pose/".concat(e)});n.setOptions({modelComplexity:0,smoothLandmarks:!0,minDetectionConfidence:.5,minTrackingConfidence:.5}),n.onResults(t),new window.Camera(e,{onFrame:async()=>{await n.send({image:e})},width:1920,height:1080}).start(),p.value="Streaming"})(y.value,P.value,k)},_=()=>{f(y.value)};return t((()=>{p.value="Pre"})),n((()=>{f(y.value)})),(e,a)=>(o(),s(l(w),null,{default:i((()=>[r(l(m),null,{default:i((()=>[d("video",{ref_key:"videoRef",ref:y,id:"videoSource",playsinline:"",autoplay:"",muted:"",style:{display:"none"}},null,512),d("canvas",{ref_key:"canvasRef",ref:P,id:"outputCanvas"},null,512),d("div",g,[r(l(c),{onClick:C},{default:i((()=>[u(h("Pre"===l(p)?"Start Pose Detection":"Retake"),1)])),_:1}),"Streaming"===l(p)?(o(),s(l(c),{key:0,onClick:_},{default:i((()=>a[0]||(a[0]=[u(" Stop ")]))),_:1})):v("",!0)])])),_:1})])),_:1}))}},[["__scopeId","data-v-236d75ca"]]);export{y as default};
