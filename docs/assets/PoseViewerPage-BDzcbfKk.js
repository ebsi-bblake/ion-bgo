import{_ as e,r as a,m as t,n as o,o as n,c as s,w as i,u as l,a as r,b as c,I as d,e as u,t as h,p as v,f as w,g as m}from"./index-BfCQjBJw.js";const f=e=>{if(e&&e.srcObject){e.srcObject.getTracks().forEach((e=>e.stop())),e.srcObject=null}},p={class:"action-buttons"},g=e({__name:"PoseViewerPage",setup(e){const g=a("Pre"),y=a(null),k=a(null),C=e=>{const a=k.value.getContext("2d");var t,o,n,s;a.clearRect(0,0,y.value.videoWidth,y.value.videoHeight),a.drawImage(e.image,0,0,k.value.width,k.value.height),console.log(window),console.log(e),e.poseLandmarks&&(t=a,o=e.poseLandmarks,n=window.POSE_CONNECTIONS,s={color:"white",lineWidth:2},t.strokeStyle=s.color,t.lineWidth=s.lineWidth,n.forEach((([e,a])=>{const n=o[e],s=o[a];n&&s&&(t.beginPath(),t.moveTo(n.x*t.canvas.width,n.y*t.canvas.height),t.lineTo(s.x*t.canvas.width,s.y*t.canvas.height),t.stroke())})),((e,a,t)=>{e.fillStyle=t.color,a.forEach((a=>{e.beginPath(),e.arc(a.x*e.canvas.width,a.y*e.canvas.height,t.lineWidth,0,2*Math.PI),e.fill()}))})(a,e.poseLandmarks,{color:"red",lineWidth:2}))},P=async()=>{await(async(e,a,t)=>{if(!window.Pose||!window.Camera)throw new Error("MediaPipe Pose or Camera not loaded. Ensure the scripts are loaded correctly.");const o=new window.Pose({locateFile:e=>"https://cdn.jsdelivr.net/npm/@mediapipe/pose/".concat(e)});o.setOptions({modelComplexity:1,smoothLandmarks:!0,minDetectionConfidence:.5,minTrackingConfidence:.5}),o.onResults(t),new window.Camera(e,{onFrame:async()=>{await o.send({image:e})},width:1280,height:720}).start()})(y.value,k.value,C),g.value="Streaming"};return t((()=>{P()})),o((()=>{f(y.value)})),(e,a)=>(n(),s(l(m),null,{default:i((()=>[r(l(w),null,{default:i((()=>[c("video",{ref_key:"videoRef",ref:y,id:"videoSource",playsinline:"",autoplay:"",muted:"",style:{display:"none"}},null,512),c("canvas",{ref_key:"canvasRef",ref:k,id:"outputCanvas"},null,512),c("div",p,[r(l(d),{onClick:P},{default:i((()=>[u(h("Pre"===g.value?"Start Pose Detection":"Retake"),1)])),_:1}),"Streaming"===g.value?(n(),s(l(d),{key:0,onClick:l(f)},{default:i((()=>a[0]||(a[0]=[u(" Stop ")]))),_:1},8,["onClick"])):v("",!0)])])),_:1})])),_:1}))}},[["__scopeId","data-v-2f33b898"]]);export{g as default};
